%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for mutations/basics/delete-relational-post"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (mutationField)<br />Deps: 11, 110"):::bucket
    Bucket2("Bucket 2 (mutationField)<br />Deps: 111, 2<br /><br />1: Access[15]<br />2: Access[16]<br />3: Object[17]<br />4: PgDeleteSingle[14]"):::bucket
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 8, 11<br /><br />ROOT PgDeleteSingle{1}ᐸrelational_posts(id)ᐳ[8]<br />1: 92, 97<br />ᐳ: 19, 96, 18, 22<br />2: PgSelect[23]<br />ᐳ: Access[27], Access[93], Access[98]<br />3: First[28]<br />ᐳ: PgSelectSingle[29]"):::bucket
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 14, 17<br /><br />ROOT PgDeleteSingle{2}ᐸrelational_posts(id)ᐳ[14]<br />1: 101, 106<br />ᐳ: 21, 105, 20, 30<br />2: PgSelect[31]<br />ᐳ: Access[35], Access[102], Access[107]<br />3: First[36]<br />ᐳ: PgSelectSingle[37]"):::bucket
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 29, 11, 93, 98<br /><br />ROOT PgSelectSingle{3}ᐸrelational_postsᐳ[29]<br />1: <br />ᐳ: 38, 40, 42, 44, 94, 99, 95, 100, 52, 68<br />2: First[53], First[69]<br />ᐳ: 54, 55, 70, 71<br />3: PgSelect[72]<br />ᐳ: Access[74]<br />4: First[75]<br />ᐳ: PgSelectSingle[76]"):::bucket
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 37, 17, 102, 107<br /><br />ROOT PgSelectSingle{4}ᐸrelational_postsᐳ[37]<br />1: <br />ᐳ: 39, 41, 43, 45, 103, 108, 104, 109, 62, 79<br />2: First[63], First[80]<br />ᐳ: 64, 65, 81, 82<br />3: PgSelect[83]<br />ᐳ: Access[85]<br />4: First[86]<br />ᐳ: PgSelectSingle[87]"):::bucket
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 76<br /><br />ROOT PgSelectSingle{5}ᐸpeopleᐳ[76]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 87<br /><br />ROOT PgSelectSingle{6}ᐸpeopleᐳ[87]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2
    Bucket1 --> Bucket3
    Bucket2 --> Bucket4
    Bucket3 --> Bucket5
    Bucket4 --> Bucket6
    Bucket5 --> Bucket7
    Bucket6 --> Bucket8

    %% plan dependencies
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ<br />Dependents: 3"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ<br />More deps:<br />- __Value[2]"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ<br />More deps:<br />- __Value[2]"}}:::plan
    Access9 & Access10 --> Object11
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ<br />Dependents: 4"]:::plan
    PgDeleteSingle8[["PgDeleteSingle[8∈1] ➊<br />ᐸrelational_posts(id)ᐳ<br />More deps:<br />- Object[11]<br />- Constantᐸ4ᐳ[110]"]]:::sideeffectplan
    PgDeleteSingle14[["PgDeleteSingle[14∈2] ➊<br />ᐸrelational_posts(id)ᐳ<br />More deps:<br />- Constantᐸ3141592ᐳ[111]"]]:::sideeffectplan
    Object17{{"Object[17∈2] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object17 --> PgDeleteSingle14
    Access15{{"Access[15∈2] ➊<br />ᐸ2.pgSettingsᐳ<br />More deps:<br />- __Value[2]"}}:::plan
    Access16{{"Access[16∈2] ➊<br />ᐸ2.withPgClientᐳ<br />More deps:<br />- __Value[2]"}}:::plan
    Access15 & Access16 --> Object17
    PgSelect23[["PgSelect[23∈3] ➊<br />ᐸrelational_postsᐳ<br />More deps:<br />- Object[11]"]]:::plan
    PgClassExpression22{{"PgClassExpression[22∈3] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    PgSelectInlineApply92["PgSelectInlineApply[92∈3] ➊"]:::plan
    PgFromExpression96{{"PgFromExpression[96∈3] ➊"}}:::plan
    PgSelectInlineApply97["PgSelectInlineApply[97∈3] ➊"]:::plan
    PgClassExpression22 & PgSelectInlineApply92 & PgFromExpression96 & PgSelectInlineApply97 --> PgSelect23
    PgClassExpression18{{"PgClassExpression[18∈3] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Access19{{"Access[19∈3] ➊<br />ᐸ8.tᐳ"}}:::plan
    Access19 --> PgClassExpression18
    PgDeleteSingle8 --> Access19
    Access19 --> PgClassExpression22
    Access27{{"Access[27∈3] ➊<br />ᐸ23.itemsᐳ"}}:::plan
    PgSelect23 --> Access27
    First28[["First[28∈3] ➊"]]:::plan
    Access27 --> First28
    PgSelectSingle29{{"PgSelectSingle[29∈3] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First28 --> PgSelectSingle29
    Access93{{"Access[93∈3] ➊<br />ᐸ23.m.joinDetailsFor66ᐳ"}}:::plan
    PgSelect23 --> Access93
    Access98{{"Access[98∈3] ➊<br />ᐸ23.m.joinDetailsFor47ᐳ"}}:::plan
    PgSelect23 --> Access98
    PgSelect31[["PgSelect[31∈4] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression30{{"PgClassExpression[30∈4] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    PgSelectInlineApply101["PgSelectInlineApply[101∈4] ➊"]:::plan
    PgFromExpression105{{"PgFromExpression[105∈4] ➊"}}:::plan
    PgSelectInlineApply106["PgSelectInlineApply[106∈4] ➊"]:::plan
    Object17 & PgClassExpression30 & PgSelectInlineApply101 & PgFromExpression105 & PgSelectInlineApply106 --> PgSelect31
    PgClassExpression20{{"PgClassExpression[20∈4] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Access21{{"Access[21∈4] ➊<br />ᐸ14.tᐳ"}}:::plan
    Access21 --> PgClassExpression20
    PgDeleteSingle14 --> Access21
    Access21 --> PgClassExpression30
    Access35{{"Access[35∈4] ➊<br />ᐸ31.itemsᐳ"}}:::plan
    PgSelect31 --> Access35
    First36[["First[36∈4] ➊"]]:::plan
    Access35 --> First36
    PgSelectSingle37{{"PgSelectSingle[37∈4] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First36 --> PgSelectSingle37
    Access102{{"Access[102∈4] ➊<br />ᐸ31.m.joinDetailsFor77ᐳ"}}:::plan
    PgSelect31 --> Access102
    Access107{{"Access[107∈4] ➊<br />ᐸ31.m.joinDetailsFor57ᐳ"}}:::plan
    PgSelect31 --> Access107
    PgSelect72[["PgSelect[72∈5] ➊<br />ᐸpeopleᐳ<br />More deps:<br />- Object[11]"]]:::plan
    PgClassExpression71{{"PgClassExpression[71∈5] ➊<br />ᐸ__relation...author_id”ᐳ"}}:::plan
    PgClassExpression71 --> PgSelect72
    List94{{"List[94∈5] ➊<br />ᐸ93,29ᐳ"}}:::plan
    Access93 & PgSelectSingle29 --> List94
    List99{{"List[99∈5] ➊<br />ᐸ98,29ᐳ"}}:::plan
    Access98 & PgSelectSingle29 --> List99
    PgClassExpression38{{"PgClassExpression[38∈5] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle29 --> PgClassExpression38
    PgClassExpression40{{"PgClassExpression[40∈5] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle29 --> PgClassExpression40
    PgClassExpression42{{"PgClassExpression[42∈5] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle29 --> PgClassExpression42
    PgClassExpression44{{"PgClassExpression[44∈5] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle29 --> PgClassExpression44
    Access52{{"Access[52∈5] ➊<br />ᐸ100.itemsᐳ"}}:::plan
    Lambda100{{"Lambda[100∈5] ➊<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda100 --> Access52
    First53[["First[53∈5] ➊"]]:::plan
    Access52 --> First53
    PgSelectSingle54{{"PgSelectSingle[54∈5] ➊<br />ᐸtextᐳ"}}:::plan
    First53 --> PgSelectSingle54
    PgClassExpression55{{"PgClassExpression[55∈5] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle54 --> PgClassExpression55
    Access68{{"Access[68∈5] ➊<br />ᐸ95.itemsᐳ"}}:::plan
    Lambda95{{"Lambda[95∈5] ➊<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda95 --> Access68
    First69[["First[69∈5] ➊"]]:::plan
    Access68 --> First69
    PgSelectSingle70{{"PgSelectSingle[70∈5] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First69 --> PgSelectSingle70
    PgSelectSingle70 --> PgClassExpression71
    Access74{{"Access[74∈5] ➊<br />ᐸ72.itemsᐳ"}}:::plan
    PgSelect72 --> Access74
    First75[["First[75∈5] ➊"]]:::plan
    Access74 --> First75
    PgSelectSingle76{{"PgSelectSingle[76∈5] ➊<br />ᐸpeopleᐳ"}}:::plan
    First75 --> PgSelectSingle76
    List94 --> Lambda95
    List99 --> Lambda100
    PgSelect83[["PgSelect[83∈6] ➊<br />ᐸpeopleᐳ"]]:::plan
    PgClassExpression82{{"PgClassExpression[82∈6] ➊<br />ᐸ__relation...author_id”ᐳ"}}:::plan
    Object17 & PgClassExpression82 --> PgSelect83
    List103{{"List[103∈6] ➊<br />ᐸ102,37ᐳ"}}:::plan
    Access102 & PgSelectSingle37 --> List103
    List108{{"List[108∈6] ➊<br />ᐸ107,37ᐳ"}}:::plan
    Access107 & PgSelectSingle37 --> List108
    PgClassExpression39{{"PgClassExpression[39∈6] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle37 --> PgClassExpression39
    PgClassExpression41{{"PgClassExpression[41∈6] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle37 --> PgClassExpression41
    PgClassExpression43{{"PgClassExpression[43∈6] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle37 --> PgClassExpression43
    PgClassExpression45{{"PgClassExpression[45∈6] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle37 --> PgClassExpression45
    Access62{{"Access[62∈6] ➊<br />ᐸ109.itemsᐳ"}}:::plan
    Lambda109{{"Lambda[109∈6] ➊<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda109 --> Access62
    First63[["First[63∈6] ➊"]]:::plan
    Access62 --> First63
    PgSelectSingle64{{"PgSelectSingle[64∈6] ➊<br />ᐸtextᐳ"}}:::plan
    First63 --> PgSelectSingle64
    PgClassExpression65{{"PgClassExpression[65∈6] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle64 --> PgClassExpression65
    Access79{{"Access[79∈6] ➊<br />ᐸ104.itemsᐳ"}}:::plan
    Lambda104{{"Lambda[104∈6] ➊<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda104 --> Access79
    First80[["First[80∈6] ➊"]]:::plan
    Access79 --> First80
    PgSelectSingle81{{"PgSelectSingle[81∈6] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First80 --> PgSelectSingle81
    PgSelectSingle81 --> PgClassExpression82
    Access85{{"Access[85∈6] ➊<br />ᐸ83.itemsᐳ"}}:::plan
    PgSelect83 --> Access85
    First86[["First[86∈6] ➊"]]:::plan
    Access85 --> First86
    PgSelectSingle87{{"PgSelectSingle[87∈6] ➊<br />ᐸpeopleᐳ"}}:::plan
    First86 --> PgSelectSingle87
    List103 --> Lambda104
    List108 --> Lambda109
    PgClassExpression88{{"PgClassExpression[88∈7] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle76 --> PgClassExpression88
    PgClassExpression90{{"PgClassExpression[90∈7] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle76 --> PgClassExpression90
    PgClassExpression89{{"PgClassExpression[89∈8] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle87 --> PgClassExpression89
    PgClassExpression91{{"PgClassExpression[91∈8] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle87 --> PgClassExpression91

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,Access9,Access10,Object11 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgDeleteSingle8 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgDeleteSingle14,Access15,Access16,Object17 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression18,Access19,PgClassExpression22,PgSelect23,Access27,First28,PgSelectSingle29,PgSelectInlineApply92,Access93,PgFromExpression96,PgSelectInlineApply97,Access98 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgClassExpression20,Access21,PgClassExpression30,PgSelect31,Access35,First36,PgSelectSingle37,PgSelectInlineApply101,Access102,PgFromExpression105,PgSelectInlineApply106,Access107 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgClassExpression38,PgClassExpression40,PgClassExpression42,PgClassExpression44,Access52,First53,PgSelectSingle54,PgClassExpression55,Access68,First69,PgSelectSingle70,PgClassExpression71,PgSelect72,Access74,First75,PgSelectSingle76,List94,Lambda95,List99,Lambda100 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgClassExpression39,PgClassExpression41,PgClassExpression43,PgClassExpression45,Access62,First63,PgSelectSingle64,PgClassExpression65,Access79,First80,PgSelectSingle81,PgClassExpression82,PgSelect83,Access85,First86,PgSelectSingle87,List103,Lambda104,List108,Lambda109 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression88,PgClassExpression90 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression89,PgClassExpression91 bucket8

