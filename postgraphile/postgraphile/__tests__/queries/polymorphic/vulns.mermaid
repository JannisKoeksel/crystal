%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/polymorphic/vulns"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 11, 12, 16, 21, 36, 80, 109, 110, 111, 13, 15<br />2: 10, 19, 28<br />ᐳ: Access[62], Access[107], Access[108]<br />3: Connection[14], First[29]<br />ᐳ: PgClassExpression[32]<br />4: ConnectionItems[25]<br />5: First[60], Last[66]<br />ᐳ: PgCursor[63], PgCursor[68]"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 14, 62, 80, 25, 13, 32, 63, 68<br /><br />ROOT Connectionᐸ10ᐳ[14]"):::bucket
    Bucket2("Bucket 2 (listItem)<br />Deps: 36, 13<br /><br />ROOT __Item{2}ᐸ107ᐳ[23]"):::bucket
    Bucket4("Bucket 4 (polymorphic)<br />__typename: Access[39]<br />Deps: 39, 13, 40"):::bucket
    Bucket5("Bucket 5 (polymorphicPartition)<br />|FirstPartyVulnerability<br />Deps: 13, 40<br />ᐳFirstPartyVulnerability<br /><br />1: PgSelect[41]<br />ᐳ: Access[45]<br />2: First[46]<br />ᐳ: 47, 58, 64, 69"):::bucket
    Bucket6("Bucket 6 (polymorphicPartition)<br />|ThirdPartyVulnerability<br />Deps: 13, 40<br />ᐳThirdPartyVulnerability<br /><br />1: PgSelect[49]<br />ᐳ: Access[53]<br />2: First[54]<br />ᐳ: 55, 59, 65, 70, 72"):::bucket
    Bucket7("Bucket 7 (listItem)<br />Deps: 62, 80, 13<br /><br />ROOT __Item{7}ᐸ25ᐳ[56]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 82, 57, 13, 84, 76<br /><br />ROOT Edge{7}[57]"):::bucket
    Bucket9("Bucket 9 (polymorphic)<br />__typename: Access[83]<br />Deps: 83, 13, 84"):::bucket
    Bucket10("Bucket 10 (polymorphicPartition)<br />|FirstPartyVulnerability<br />Deps: 13, 84<br />ᐳFirstPartyVulnerability<br /><br />1: PgSelect[85]<br />ᐳ: Access[89]<br />2: First[90]<br />ᐳ: 91, 100, 102, 104"):::bucket
    Bucket11("Bucket 11 (polymorphicPartition)<br />|ThirdPartyVulnerability<br />Deps: 13, 84<br />ᐳThirdPartyVulnerability<br /><br />1: PgSelect[93]<br />ᐳ: Access[97]<br />2: First[98]<br />ᐳ: 99, 101, 103, 105, 106"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2
    Bucket1 --> Bucket7
    Bucket2 --> Bucket4
    Bucket4 --> Bucket5 & Bucket6
    Bucket7 --> Bucket8
    Bucket8 --> Bucket9
    Bucket9 --> Bucket10 & Bucket11

    %% plan dependencies
    PgUnionAll10[["PgUnionAll[10∈0] ➊<br />ᐸFirstPartyVulnerability,ThirdPartyVulnerabilityᐳ<br />More deps:<br />- Object[13]<br />- Constantᐸ3ᐳ[109]<br />- Constantᐸ[Function: applyInputConstant]ᐳ[16]"]]:::plan
    Lambda15{{"Lambda[15∈0] ➊<br />ᐸparseCursorᐳ<br />More deps:<br />- Constantᐸ'WyJkNGRlODQ2NjQ3IiwiMTAiLCJUaGlyZFBhcnR5VnVsbmVyYWJpbGl0eSIᐳ[110]"}}:::plan
    Lambda15 --> PgUnionAll10
    PgUnionAll19[["PgUnionAll[19∈0] ➊<br />ᐸFirstPartyVulnerability,ThirdPartyVulnerabilityᐳ<br />More deps:<br />- Object[13]<br />- Constantᐸ3ᐳ[109]<br />- Constantᐸ1ᐳ[111]<br />- Constantᐸ[Function: applyInputConstant]ᐳ[21]"]]:::plan
    PgUnionAll28[["PgUnionAll[28∈0] ➊<br />ᐸFirstPartyVulnerability,ThirdPartyVulnerabilityᐳ<br />More deps:<br />- Object[13]<br />- Constantᐸ3ᐳ[109]<br />- Constantᐸ[Function: applyInputConstant]ᐳ[16]"]]:::plan
    Lambda15 --> PgUnionAll28
    Connection14[["Connection[14∈0] ➊<br />ᐸ10ᐳ<br />Dependents: 2<br />More deps:<br />- Constantᐸ3ᐳ[109]"]]:::plan
    PgUnionAll10 & Lambda15 --> Connection14
    Object13{{"Object[13∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ<br />Dependents: 7"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access12{{"Access[12∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access11 & Access12 --> Object13
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access11
    __Value2 --> Access12
    ConnectionItems25[["ConnectionItems[25∈0] ➊<br />Dependents: 3<br />More deps:<br />- Connection[14]"]]:::plan
    First29[["First[29∈0] ➊"]]:::plan
    Access108{{"Access[108∈0] ➊<br />ᐸ28.itemsᐳ"}}:::plan
    Access108 --> First29
    First60[["First[60∈0] ➊<br />More deps:<br />- ConnectionItems[25]"]]:::plan
    Access62{{"Access[62∈0] ➊<br />ᐸ10.cursorDetailsᐳ<br />Dependents: 3"}}:::plan
    PgUnionAll10 --> Access62
    Last66[["Last[66∈0] ➊<br />More deps:<br />- ConnectionItems[25]"]]:::plan
    Access107{{"Access[107∈0] ➊<br />ᐸ19.itemsᐳ"}}:::plan
    PgUnionAll19 --> Access107
    PgUnionAll28 --> Access108
    PageInfo33{{"PageInfo[33∈1] ➊<br />More deps:<br />- Connection[14]"}}:::plan
    List37{{"List[37∈2]<br />ᐸ34,35,36ᐳ<br />More deps:<br />- Constantᐸ[HIDDEN]ᐳ[36]"}}:::plan
    Access34{{"Access[34∈2]<br />ᐸ23.0ᐳ"}}:::plan
    Access35{{"Access[35∈2]<br />ᐸ23.1ᐳ"}}:::plan
    Access34 & Access35 --> List37
    __Item23[/"__Item[23∈2]<br />ᐸ107ᐳ"\]:::itemplan
    Access107 ==> __Item23
    __Item23 --> Access34
    __Item23 --> Access35
    Lambda38{{"Lambda[38∈2]<br />ᐸtoSpecifierᐳ"}}:::plan
    List37 --> Lambda38
    Access39{{"Access[39∈2]<br />ᐸ38.__typenameᐳ"}}:::plan
    Lambda38 --> Access39
    Access40{{"Access[40∈2]<br />ᐸ38.idᐳ"}}:::plan
    Lambda38 --> Access40
    PgSelect41[["PgSelect[41∈5]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳFirstPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access40 --> PgSelect41
    Access45{{"Access[45∈5]^<br />ᐸ41.itemsᐳ"}}:::plan
    PgSelect41 --> Access45
    First46[["First[46∈5]^"]]:::plan
    Access45 --> First46
    PgSelectSingle47{{"PgSelectSingle[47∈5]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First46 --> PgSelectSingle47
    PgClassExpression58{{"PgClassExpression[58∈5]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle47 --> PgClassExpression58
    PgClassExpression64{{"PgClassExpression[64∈5]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle47 --> PgClassExpression64
    PgClassExpression69{{"PgClassExpression[69∈5]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle47 --> PgClassExpression69
    PgSelect49[["PgSelect[49∈6]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳThirdPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access40 --> PgSelect49
    Access53{{"Access[53∈6]^<br />ᐸ49.itemsᐳ"}}:::plan
    PgSelect49 --> Access53
    First54[["First[54∈6]^"]]:::plan
    Access53 --> First54
    PgSelectSingle55{{"PgSelectSingle[55∈6]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First54 --> PgSelectSingle55
    PgClassExpression59{{"PgClassExpression[59∈6]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression59
    PgClassExpression65{{"PgClassExpression[65∈6]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression65
    PgClassExpression70{{"PgClassExpression[70∈6]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression70
    PgClassExpression72{{"PgClassExpression[72∈6]^<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression72
    List81{{"List[81∈7]<br />ᐸ78,79,80ᐳ<br />More deps:<br />- Constantᐸ[HIDDEN]ᐳ[80]"}}:::plan
    Access78{{"Access[78∈7]<br />ᐸ56.0ᐳ"}}:::plan
    Access79{{"Access[79∈7]<br />ᐸ56.1ᐳ"}}:::plan
    Access78 & Access79 --> List81
    Edge57{{"Edge[57∈7]"}}:::plan
    __Item56[/"__Item[56∈7]<br />ᐸ25ᐳ<br />More deps:<br />- ConnectionItems[25]"\]:::itemplan
    PgCursor76{{"PgCursor[76∈7]<br />More deps:<br />- Access[62]"}}:::plan
    __Item56 & PgCursor76 --> Edge57
    __Item56 --> PgCursor76
    __Item56 --> Access78
    __Item56 --> Access79
    Lambda82{{"Lambda[82∈7]<br />ᐸtoSpecifierᐳ"}}:::plan
    List81 --> Lambda82
    Access84{{"Access[84∈7]<br />ᐸ82.idᐳ"}}:::plan
    Lambda82 --> Access84
    Access83{{"Access[83∈8]<br />ᐸ82.__typenameᐳ"}}:::plan
    Lambda82 --> Access83
    PgSelect85[["PgSelect[85∈10]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳFirstPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access84 --> PgSelect85
    Access89{{"Access[89∈10]^<br />ᐸ85.itemsᐳ"}}:::plan
    PgSelect85 --> Access89
    First90[["First[90∈10]^"]]:::plan
    Access89 --> First90
    PgSelectSingle91{{"PgSelectSingle[91∈10]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First90 --> PgSelectSingle91
    PgClassExpression100{{"PgClassExpression[100∈10]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle91 --> PgClassExpression100
    PgClassExpression102{{"PgClassExpression[102∈10]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle91 --> PgClassExpression102
    PgClassExpression104{{"PgClassExpression[104∈10]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle91 --> PgClassExpression104
    PgSelect93[["PgSelect[93∈11]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳThirdPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access84 --> PgSelect93
    Access97{{"Access[97∈11]^<br />ᐸ93.itemsᐳ"}}:::plan
    PgSelect93 --> Access97
    First98[["First[98∈11]^"]]:::plan
    Access97 --> First98
    PgSelectSingle99{{"PgSelectSingle[99∈11]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First98 --> PgSelectSingle99
    PgClassExpression101{{"PgClassExpression[101∈11]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle99 --> PgClassExpression101
    PgClassExpression103{{"PgClassExpression[103∈11]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle99 --> PgClassExpression103
    PgClassExpression105{{"PgClassExpression[105∈11]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle99 --> PgClassExpression105
    PgClassExpression106{{"PgClassExpression[106∈11]^<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan
    PgSelectSingle99 --> PgClassExpression106

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,PgUnionAll10,Access11,Access12,Object13,Connection14,Lambda15,PgUnionAll19,ConnectionItems25,PgUnionAll28,First29,First60,Access62,Last66,Access107,Access108 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PageInfo33 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item23,Access34,Access35,List37,Lambda38,Access39,Access40 bucket2
    classDef bucket4 stroke:#0000ff
    class Bucket4 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgSelect41,Access45,First46,PgSelectSingle47,PgClassExpression58,PgClassExpression64,PgClassExpression69 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgSelect49,Access53,First54,PgSelectSingle55,PgClassExpression59,PgClassExpression65,PgClassExpression70,PgClassExpression72 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item56,Edge57,PgCursor76,Access78,Access79,List81,Lambda82,Access84 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,Access83 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgSelect85,Access89,First90,PgSelectSingle91,PgClassExpression100,PgClassExpression102,PgClassExpression104 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgSelect93,Access97,First98,PgSelectSingle99,PgClassExpression101,PgClassExpression103,PgClassExpression105,PgClassExpression106 bucket11

