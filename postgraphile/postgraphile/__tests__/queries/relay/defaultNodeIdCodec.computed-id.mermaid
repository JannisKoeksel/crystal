%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/relay/defaultNodeIdCodec.computed-id"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 11, 12, 28, 243, 244, 245, 246, 247, 248, 249, 250, 7, 8, 13, 18, 19, 29, 30, 56, 57, 83, 84, 110, 111, 137, 138, 163, 164, 190, 191, 217, 218<br />2: 32, 59, 86, 113, 140, 166, 193, 220<br />3: 35, 62, 89, 116, 143, 169, 196, 223<br />ᐳ: 34, 36, 37, 40, 53, 61, 63, 64, 67, 80, 88, 90, 91, 94, 107, 115, 117, 118, 121, 134, 142, 144, 145, 148, 161, 168, 170, 171, 174, 187, 195, 197, 198, 201, 214, 222, 224, 225, 228, 241<br />4: PgSelect[10], PgSelect[21]<br />5: PgSelectRows[15], PgSelectRows[24]<br />ᐳ: 14, 16, 23, 25"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 16<br /><br />ROOT PgSelectSingleᐸusersᐳ[16]"):::bucket
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 25<br /><br />ROOT PgSelectSingleᐸusersᐳ[25]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2

    %% plan dependencies
    PgSelect10[["PgSelect[10∈0] ➊<br />ᐸusersᐳ"]]:::plan
    Object13{{"Object[13∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access8{{"Access[8∈0] ➊<br />ᐸ7.1ᐳ"}}:::plan
    PgFromExpression40{{"PgFromExpression[40∈0] ➊"}}:::plan
    PgFromExpression67{{"PgFromExpression[67∈0] ➊"}}:::plan
    PgFromExpression94{{"PgFromExpression[94∈0] ➊"}}:::plan
    PgFromExpression121{{"PgFromExpression[121∈0] ➊"}}:::plan
    PgFromExpression148{{"PgFromExpression[148∈0] ➊"}}:::plan
    PgFromExpression174{{"PgFromExpression[174∈0] ➊"}}:::plan
    PgFromExpression201{{"PgFromExpression[201∈0] ➊"}}:::plan
    PgFromExpression228{{"PgFromExpression[228∈0] ➊"}}:::plan
    Access8 -->|rejectNull| PgSelect10
    Object13 & PgFromExpression40 & PgFromExpression67 & PgFromExpression94 & PgFromExpression121 & PgFromExpression148 & PgFromExpression174 & PgFromExpression201 & PgFromExpression228 --> PgSelect10
    PgSelect21[["PgSelect[21∈0] ➊<br />ᐸusersᐳ"]]:::plan
    Access19{{"Access[19∈0] ➊<br />ᐸ18.1ᐳ"}}:::plan
    PgFromExpression53{{"PgFromExpression[53∈0] ➊"}}:::plan
    PgFromExpression80{{"PgFromExpression[80∈0] ➊"}}:::plan
    PgFromExpression107{{"PgFromExpression[107∈0] ➊"}}:::plan
    PgFromExpression134{{"PgFromExpression[134∈0] ➊"}}:::plan
    PgFromExpression161{{"PgFromExpression[161∈0] ➊"}}:::plan
    PgFromExpression187{{"PgFromExpression[187∈0] ➊"}}:::plan
    PgFromExpression214{{"PgFromExpression[214∈0] ➊"}}:::plan
    PgFromExpression241{{"PgFromExpression[241∈0] ➊"}}:::plan
    Access19 -->|rejectNull| PgSelect21
    Object13 & PgFromExpression53 & PgFromExpression80 & PgFromExpression107 & PgFromExpression134 & PgFromExpression161 & PgFromExpression187 & PgFromExpression214 & PgFromExpression241 --> PgSelect21
    Access11{{"Access[11∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access12{{"Access[12∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access11 & Access12 --> Object13
    PgSelect32[["PgSelect[32∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access30{{"Access[30∈0] ➊<br />ᐸ29.1ᐳ"}}:::plan
    Access30 -->|rejectNull| PgSelect32
    Object13 --> PgSelect32
    PgSelect59[["PgSelect[59∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access57{{"Access[57∈0] ➊<br />ᐸ56.1ᐳ"}}:::plan
    Access57 -->|rejectNull| PgSelect59
    Object13 --> PgSelect59
    PgSelect86[["PgSelect[86∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access84{{"Access[84∈0] ➊<br />ᐸ83.1ᐳ"}}:::plan
    Access84 -->|rejectNull| PgSelect86
    Object13 --> PgSelect86
    PgSelect113[["PgSelect[113∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access111{{"Access[111∈0] ➊<br />ᐸ110.1ᐳ"}}:::plan
    Access111 -->|rejectNull| PgSelect113
    Object13 --> PgSelect113
    PgSelect140[["PgSelect[140∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access138{{"Access[138∈0] ➊<br />ᐸ137.1ᐳ"}}:::plan
    Access138 -->|rejectNull| PgSelect140
    Object13 --> PgSelect140
    PgSelect166[["PgSelect[166∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access164{{"Access[164∈0] ➊<br />ᐸ163.1ᐳ"}}:::plan
    Access164 -->|rejectNull| PgSelect166
    Object13 --> PgSelect166
    PgSelect193[["PgSelect[193∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access191{{"Access[191∈0] ➊<br />ᐸ190.1ᐳ"}}:::plan
    Access191 -->|rejectNull| PgSelect193
    Object13 --> PgSelect193
    PgSelect220[["PgSelect[220∈0] ➊<br />ᐸspectaclesᐳ"]]:::plan
    Access218{{"Access[218∈0] ➊<br />ᐸ217.1ᐳ"}}:::plan
    Access218 -->|rejectNull| PgSelect220
    Object13 --> PgSelect220
    Lambda7{{"Lambda[7∈0] ➊<br />ᐸspecifier_User_pipeStringᐳ<br />More deps:<br />- Constantᐸ'users|1'ᐳ[243]"}}:::plan
    Lambda7 --> Access8
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access11
    __Value2 --> Access12
    First14{{"First[14∈0] ➊"}}:::plan
    PgSelectRows15[["PgSelectRows[15∈0] ➊"]]:::plan
    PgSelectRows15 --> First14
    PgSelect10 --> PgSelectRows15
    PgSelectSingle16{{"PgSelectSingle[16∈0] ➊<br />ᐸusersᐳ"}}:::plan
    First14 --> PgSelectSingle16
    Lambda18{{"Lambda[18∈0] ➊<br />ᐸspecifier_User_pipeStringᐳ<br />More deps:<br />- Constantᐸ'users|2'ᐳ[244]"}}:::plan
    Lambda18 --> Access19
    First23{{"First[23∈0] ➊"}}:::plan
    PgSelectRows24[["PgSelectRows[24∈0] ➊"]]:::plan
    PgSelectRows24 --> First23
    PgSelect21 --> PgSelectRows24
    PgSelectSingle25{{"PgSelectSingle[25∈0] ➊<br />ᐸusersᐳ"}}:::plan
    First23 --> PgSelectSingle25
    Lambda29{{"Lambda[29∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸundefinedᐳ[28]"}}:::plan
    Lambda29 --> Access30
    First34{{"First[34∈0] ➊"}}:::plan
    PgSelectRows35[["PgSelectRows[35∈0] ➊"]]:::plan
    PgSelectRows35 --> First34
    PgSelect32 --> PgSelectRows35
    PgSelectSingle36{{"PgSelectSingle[36∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First34 --> PgSelectSingle36
    PgClassExpression37{{"PgClassExpression[37∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle36 --> PgClassExpression37
    PgClassExpression37 -->|trapInhibited| PgFromExpression40
    PgClassExpression37 -->|trapInhibited| PgFromExpression53
    Lambda56{{"Lambda[56∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'spectacles|1'ᐳ[245]"}}:::plan
    Lambda56 --> Access57
    First61{{"First[61∈0] ➊"}}:::plan
    PgSelectRows62[["PgSelectRows[62∈0] ➊"]]:::plan
    PgSelectRows62 --> First61
    PgSelect59 --> PgSelectRows62
    PgSelectSingle63{{"PgSelectSingle[63∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First61 --> PgSelectSingle63
    PgClassExpression64{{"PgClassExpression[64∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle63 --> PgClassExpression64
    PgClassExpression64 -->|trapInhibited| PgFromExpression67
    PgClassExpression64 -->|trapInhibited| PgFromExpression80
    Lambda83{{"Lambda[83∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'spectacles|2'ᐳ[246]"}}:::plan
    Lambda83 --> Access84
    First88{{"First[88∈0] ➊"}}:::plan
    PgSelectRows89[["PgSelectRows[89∈0] ➊"]]:::plan
    PgSelectRows89 --> First88
    PgSelect86 --> PgSelectRows89
    PgSelectSingle90{{"PgSelectSingle[90∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First88 --> PgSelectSingle90
    PgClassExpression91{{"PgClassExpression[91∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression91
    PgClassExpression91 -->|trapInhibited| PgFromExpression94
    PgClassExpression91 -->|trapInhibited| PgFromExpression107
    Lambda110{{"Lambda[110∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'spectacles|3'ᐳ[247]"}}:::plan
    Lambda110 --> Access111
    First115{{"First[115∈0] ➊"}}:::plan
    PgSelectRows116[["PgSelectRows[116∈0] ➊"]]:::plan
    PgSelectRows116 --> First115
    PgSelect113 --> PgSelectRows116
    PgSelectSingle117{{"PgSelectSingle[117∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First115 --> PgSelectSingle117
    PgClassExpression118{{"PgClassExpression[118∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle117 --> PgClassExpression118
    PgClassExpression118 -->|trapInhibited| PgFromExpression121
    PgClassExpression118 -->|trapInhibited| PgFromExpression134
    Lambda137{{"Lambda[137∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'spectacles|4'ᐳ[248]"}}:::plan
    Lambda137 --> Access138
    First142{{"First[142∈0] ➊"}}:::plan
    PgSelectRows143[["PgSelectRows[143∈0] ➊"]]:::plan
    PgSelectRows143 --> First142
    PgSelect140 --> PgSelectRows143
    PgSelectSingle144{{"PgSelectSingle[144∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First142 --> PgSelectSingle144
    PgClassExpression145{{"PgClassExpression[145∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle144 --> PgClassExpression145
    PgClassExpression145 -->|trapInhibited| PgFromExpression148
    PgClassExpression145 -->|trapInhibited| PgFromExpression161
    Lambda163{{"Lambda[163∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'users|1'ᐳ[243]"}}:::plan
    Lambda163 --> Access164
    First168{{"First[168∈0] ➊"}}:::plan
    PgSelectRows169[["PgSelectRows[169∈0] ➊"]]:::plan
    PgSelectRows169 --> First168
    PgSelect166 --> PgSelectRows169
    PgSelectSingle170{{"PgSelectSingle[170∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First168 --> PgSelectSingle170
    PgClassExpression171{{"PgClassExpression[171∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle170 --> PgClassExpression171
    PgClassExpression171 -->|trapInhibited| PgFromExpression174
    PgClassExpression171 -->|trapInhibited| PgFromExpression187
    Lambda190{{"Lambda[190∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'query'ᐳ[249]"}}:::plan
    Lambda190 --> Access191
    First195{{"First[195∈0] ➊"}}:::plan
    PgSelectRows196[["PgSelectRows[196∈0] ➊"]]:::plan
    PgSelectRows196 --> First195
    PgSelect193 --> PgSelectRows196
    PgSelectSingle197{{"PgSelectSingle[197∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First195 --> PgSelectSingle197
    PgClassExpression198{{"PgClassExpression[198∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle197 --> PgClassExpression198
    PgClassExpression198 -->|trapInhibited| PgFromExpression201
    PgClassExpression198 -->|trapInhibited| PgFromExpression214
    Lambda217{{"Lambda[217∈0] ➊<br />ᐸspecifier_Spectacle_pipeStringᐳ<br />More deps:<br />- Constantᐸ'invalidnodeid'ᐳ[250]"}}:::plan
    Lambda217 --> Access218
    First222{{"First[222∈0] ➊"}}:::plan
    PgSelectRows223[["PgSelectRows[223∈0] ➊"]]:::plan
    PgSelectRows223 --> First222
    PgSelect220 --> PgSelectRows223
    PgSelectSingle224{{"PgSelectSingle[224∈0] ➊<br />ᐸspectaclesᐳ"}}:::plan
    First222 --> PgSelectSingle224
    PgClassExpression225{{"PgClassExpression[225∈0] ➊<br />ᐸ__spectacles__ᐳ"}}:::plan
    PgSelectSingle224 --> PgClassExpression225
    PgClassExpression225 -->|trapInhibited| PgFromExpression228
    PgClassExpression225 -->|trapInhibited| PgFromExpression241
    PgClassExpression26{{"PgClassExpression[26∈1] ➊<br />ᐸ__users__.”username”ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression26
    PgClassExpression41{{"PgClassExpression[41∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression41
    PgClassExpression68{{"PgClassExpression[68∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression68
    PgClassExpression95{{"PgClassExpression[95∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression95
    PgClassExpression122{{"PgClassExpression[122∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression122
    PgClassExpression149{{"PgClassExpression[149∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression149
    PgClassExpression175{{"PgClassExpression[175∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression175
    PgClassExpression202{{"PgClassExpression[202∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression202
    PgClassExpression229{{"PgClassExpression[229∈1] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle16 --> PgClassExpression229
    PgClassExpression27{{"PgClassExpression[27∈2] ➊<br />ᐸ__users__.”username”ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression27
    PgClassExpression54{{"PgClassExpression[54∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression54
    PgClassExpression81{{"PgClassExpression[81∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression81
    PgClassExpression108{{"PgClassExpression[108∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression108
    PgClassExpression135{{"PgClassExpression[135∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression135
    PgClassExpression162{{"PgClassExpression[162∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression162
    PgClassExpression188{{"PgClassExpression[188∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression188
    PgClassExpression215{{"PgClassExpression[215∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression215
    PgClassExpression242{{"PgClassExpression[242∈2] ➊<br />ᐸ(1/0) /* E...ferred! */ᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression242

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,Lambda7,Access8,PgSelect10,Access11,Access12,Object13,First14,PgSelectRows15,PgSelectSingle16,Lambda18,Access19,PgSelect21,First23,PgSelectRows24,PgSelectSingle25,Lambda29,Access30,PgSelect32,First34,PgSelectRows35,PgSelectSingle36,PgClassExpression37,PgFromExpression40,PgFromExpression53,Lambda56,Access57,PgSelect59,First61,PgSelectRows62,PgSelectSingle63,PgClassExpression64,PgFromExpression67,PgFromExpression80,Lambda83,Access84,PgSelect86,First88,PgSelectRows89,PgSelectSingle90,PgClassExpression91,PgFromExpression94,PgFromExpression107,Lambda110,Access111,PgSelect113,First115,PgSelectRows116,PgSelectSingle117,PgClassExpression118,PgFromExpression121,PgFromExpression134,Lambda137,Access138,PgSelect140,First142,PgSelectRows143,PgSelectSingle144,PgClassExpression145,PgFromExpression148,PgFromExpression161,Lambda163,Access164,PgSelect166,First168,PgSelectRows169,PgSelectSingle170,PgClassExpression171,PgFromExpression174,PgFromExpression187,Lambda190,Access191,PgSelect193,First195,PgSelectRows196,PgSelectSingle197,PgClassExpression198,PgFromExpression201,PgFromExpression214,Lambda217,Access218,PgSelect220,First222,PgSelectRows223,PgSelectSingle224,PgClassExpression225,PgFromExpression228,PgFromExpression241 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgClassExpression26,PgClassExpression41,PgClassExpression68,PgClassExpression95,PgClassExpression122,PgClassExpression149,PgClassExpression175,PgClassExpression202,PgClassExpression229 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression27,PgClassExpression54,PgClassExpression81,PgClassExpression108,PgClassExpression135,PgClassExpression162,PgClassExpression188,PgClassExpression215,PgClassExpression242 bucket2

